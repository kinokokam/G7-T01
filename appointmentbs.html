<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Appointment Booking with Limited Calendar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="...PtmoHDEXuppvnDJzQIu9"
    crossorigin="anonymous">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="external.css"> <!-- Link to the external stylesheet -->
    <link rel="stylesheet" href="appointmentBooking.css"> <!-- Link to the appointmentBooking stylesheet -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
</head>
<body>

<div id="app" class="container mt-4">
    <div class="row g-5">
        <!-- Calendar Section -->
        <div class="col-lg-6 calendar-container">
            <h1>{{ currentMonthName }} {{ currentYear }}</h1>
            <div class="calendar">
                <div v-for="day in daysOfWeek" :key="day">{{ day }}</div>
                <div v-for="n in firstDayOffset" :key="'empty-' + n"></div>
                <div v-for="day in daysInMonth" :key="day" 
                     :class="{ 'selected': selectedDate === day }" 
                     @click="selectDate(day)">
                     {{ day }}
                </div>
            </div>
            <div class="carousel-controls">
                <button @click="previousMonth" :disabled="isPreviousDisabled">Previous</button>
                <button @click="nextMonth" :disabled="isNextDisabled">Next</button>
            </div>
        </div>
        
        <!-- Booking Form Section -->
        <div class="col-lg-6 booking-form-container">
            <h1>Book Your Appointment</h1>
            <form @submit.prevent="submitForm">
                <label for="name">Full Name</label>
                <input type="text" id="name" v-model="form.name" required>

                <label for="email">Email Address</label>
                <input type="email" id="email" v-model="form.email" required>

                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" v-model="form.phone" required>

                <label for="agency">Renovation Agency</label>
                <input type="text" id="agency" v-model="form.agency" required>

                <button type="submit">Book Appointment</button>
            </form>
        </div>
    </div>
</div>

<script>
new Vue({
    el: '#app',
    data: {
        currentMonth: new Date().getMonth(), // Current month (0-indexed)
        currentYear: new Date().getFullYear(),
        form: {
            name: '',
            email: '',
            phone: '',
            agency: '',
        },
        daysOfWeek: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        selectedDate: null, // Store selected date
        startMonth: new Date().getMonth(), // Current month (for disabling "Previous")
        endMonth: (new Date().getMonth() + 3) % 12 // Limit to 3 months ahead (for disabling "Next")
    },
    computed: {
        currentMonthName() {
            return new Date(this.currentYear, this.currentMonth).toLocaleString('default', { month: 'long' });
        },
        daysInMonth() {
            return new Date(this.currentYear, this.currentMonth + 1, 0).getDate();
        },
        firstDayOffset() {
            return new Date(this.currentYear, this.currentMonth, 1).getDay();
        },
        isPreviousDisabled() {
            return this.currentMonth === this.startMonth && this.currentYear === new Date().getFullYear();
        },
        isNextDisabled() {
            let nextMonth = this.currentMonth + 1;
            let endYear = this.currentYear;
            if (nextMonth > 11) {
                nextMonth = 0;
                endYear += 1;
            }
            return nextMonth === this.endMonth && endYear === new Date().getFullYear();
        }
    },
    methods: {
        selectDate(day) {
            // Set selected date to the clicked day
            this.selectedDate = day; // Set the clicked date
        },
        submitForm() {
            if (!this.selectedDate) {
                alert('Please select a date from the calendar.');
                return;
            }
            // Simulate sending form data to another file (you can change this logic based on your requirements)
            const appointmentData = {
                ...this.form,
                date: new Date(this.currentYear, this.currentMonth, this.selectedDate).toISOString().split('T')[0], // Add the selected date
            };
            console.log('Form submitted:', appointmentData);
            alert(`Appointment booked for ${this.form.name} on ${appointmentData.date}`);
            // Reset the form after submission
            this.resetForm();
        },
        resetForm() {
            this.form.name = '';
            this.form.email = '';
            this.form.phone = '';
            this.form.agency = '';
            this.selectedDate = null; // Reset selected date
        },
        nextMonth() {
            if (!this.isNextDisabled) {
                if (this.currentMonth === 11) {
                    this.currentMonth = 0;
                    this.currentYear++;
                } else {
                    this.currentMonth++;
                }
            }
        },
        previousMonth() {
            if (!this.isPreviousDisabled) {
                if (this.currentMonth === 0) {
                    this.currentMonth = 11;
                    this.currentYear--;
                } else {
                    this.currentMonth--;
                }
            }
        }
    }
});
</script>

</body>
</html>