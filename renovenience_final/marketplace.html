<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Real Estate Builders Free Responsive Website Templates - icon">
    <meta name="author" content="webThemez.com">
    <title>Real Estate Free Responsive Website Templates - icon</title>
    <link rel="favicon" href="assets/images/favicon.png">
    <link rel="stylesheet" media="screen" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,700">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <!-- Custom styles for our template -->
    <link rel="stylesheet" href="assets/css/bootstrap-theme.css" media="screen">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
	<script src="assets/js/html5shiv.js"></script>
	<script src="assets/js/respond.min.js"></script>
	<![endif]-->
    <!-- Axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        .btn-colour {
            background-color: rgba(80, 55, 24, 0.8);
            color: #f5f1e5;
            font-family: 'Aboreto', cursive;
            border-radius: 15px;
            padding: 20px;
        }

        .btn-check {
            background-color: rgba(80, 55, 24, 0.8);
            color: #f5f1e5;
            font-family: 'Aboreto', cursive;
            
        }
        .btn-check:hover{
             background-color: #f5f1e5;
            color: rgba(80, 55, 24, 0.8);

        }

        .btn-cart {
            background-color: rgba(80, 55, 24, 0.8);
            color: #f5f1e5;
            font-family: 'Aboreto', cursive;
            font-size: 12px;
            border-radius: 10px;
            padding: 15px;
            margin-top: auto;
            align-self: center;

        }

        .btn-colour:hover {
            background-color: #f5f1e5;
            color: rgba(80, 55, 24, 0.8);
        }

        .btn-cart:hover {
            background-color: rgba(107, 76, 39, 0.9);
            color:#f5f1e5 ;
        }


        .card {
            height: 100%;
            transition: transform 0.2s;
            margin: 5px;
            padding: 15px;
            border-radius: 20px;
            border: 1px solid rgba(80, 55, 24, 0.8);
            background-color: #f5f1e5;
            border-radius: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            margin-bottom: 20px;
            padding-bottom: 20px;

        }

        .card-deck {
            display: flex;
            flex-wrap: wrap;
            align-items: stretch;
            justify-content: space-around;
            margin-bottom: 20px;
            padding-bottom: 20px;
            padding-top: 20px;
            margin: 0 auto;
            
           

        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .search-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            gap: 10px;
        }

        .floating-cart {
            position: fixed;
            bottom: 0;
            right: 0;
            width: 100%;
            max-width: 384px;
            background: white;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            z-index: 1000;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background-color: rgba(80, 55, 24, 0.8);
            color: #f5f1e5;
            cursor: pointer;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
            font-family: 'Aboreto', cursive;
        }

        .cart-content {
            max-height: 384px;
            overflow-y: auto;
            padding: 1rem;
            font-family: 'Aboreto', cursive;
            color: rgba(80, 55, 24, 0.8);
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .cart-item img {
            width: 64px;
            height: 64px;
            object-fit: cover;
            border-radius: 4px;
        }

        .product-img {
            height: 200px;
            display: block;
            object-fit: cover;
            width: 100%;
        }

        body {

            margin: 0;
            /* Remove default margin */

            height: max-content;
            /* Full viewport height */
            width: 100vw;
            /* Full viewport width */
            background: url('./assets/images/news3.jpg') no-repeat center center/cover;
            /* Background image */

        }

        .form-control::placeholder {
            color: rgba(80, 55, 24, 0.8);
            font-family: 'Aboreto', cursive;
        }
    </style>
    <script>
        window.onload = function () {
            window.open('https://cors-anywhere.herokuapp.com/', '_blank');
        };
    </script> 
</head>

<body>
    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header">
                <!-- Button for smallest screens -->
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span
                        class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>

                <a class="navbar-brand" href="homepage.html">
                    <img src="assets/images/logo.png"
                        style="width: 100%; max-width: 300px; height: auto; display: block; margin-top: -50px; margin-left: -120px;">
                </a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav pull-right mainNav">
                    <!-- <li class="active"><a href="homepage.html" style="font-size: 13px;">Home</a></li> -->
                    <!-- <li class="active"><a href="about.html" style="font-size: 13px;">About</a></li> -->
                    <li><a href="inspiration.html" style="font-size: 13px;">Inspiration</a></li>
                    <li><a href="floorplan.html" style="font-size: 13px;">Floorplan</a></li>
                    <li><a href="interior.html" style="font-size: 13px;">Interior Design</a></li>
                    <li class="active"><a href="marketplace.html" style="font-size: 13px;">Marketplace</a></li>
                    <li><a href="booking.html" style="font-size: 13px;">Booking</a></li>
                    <li>
                        <a href="profile.html" style="font-size: 13px;">
                          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="8" r="4" stroke="#50371851" stroke-width="1" fill="none"/>
                            <path d="M4 20c0-4 4-7 8-7s8 3 8 7" stroke="#50371851" stroke-width="1" fill="none"/>
                          </svg>
                        </a>
                      </li>

                </ul>
            </div>
        </div>
    </div>
    <!-- /.navbar -->

    <!--Page title-->
    <section style="padding-top: 150px;">
        <h1 style="text-align: center; padding-top: 20px;">MarketPlace</h1>
    </section>

    <div id="marketplace">
        <div class="container">
            <!-- Search Bar -->
            <div class="search-container">
                <input type="text" v-model="searchQuery" placeholder="Search for furnitures" class="form-control"
                    style="width: 70%; border-radius: 20px; padding: 30px; font-family: 'Aboreto', cursive;">
                <button @click="searchProducts" class="btn btn-colour"
                    style="font-family: 'Aboreto', cursive;">Search</button>




            </div>

            <!-- Products Grid -->
            <div class="card-deck">
                <div v-for="(product,index) in products" :key="product.product_id" class="col-md-4 col-sm-6 mb-4">
                    <div class="card">
                        <img :src="product.thumbnails[0][0]" class="product-img" id="card-image">
                        <h5 class="mt-2">{{ product.title }}</h5>
                        <p class="text-primary" style="color:rgb(80, 55, 24); font-family: 'Aboreto', cursive;">${{ product.price }}</p>
                        <button @click="addToCart(product.product_id)" class="btn btn-cart">
                            Add to Cart
                        </button>
                    </div>
                </div>
            </div>

            <!-- Floating Cart -->
            <div class="floating-cart" v-if="true">
                <div class="cart-header" @click="toggleCart">
                    <div class="d-flex align-items-center">
                        <lucide-icon name="shopping-cart"></lucide-icon>
                        <span class="ml-2">Cart ({{ cart.length }} items)</span>
                    </div>
                    <div class="d-flex align-items-center">
                        <span class="mr-2">${{ getTotalPrice() }}</span>
                        <lucide-icon :name="isCartExpanded ? 'chevron-down' : 'chevron-up'"></lucide-icon>
                    </div>
                </div>

                <div v-if="isCartExpanded" class="cart-content">
                    <div v-if="cart.length === 0" class="text-center text-muted py-3">
                        Your cart is empty
                    </div>
                    <template v-else>
                        <div v-for="(product,index) in cart" :key="product.product_id" class="cart-item">
                            <div class="d-flex align-items-center">
                                <img :src="product.thumbnails[0][0]" :alt="product.title">
                                <div class="ml-3">
                                    <h6 class="mb-0">{{ product.title }}</h6>
                                    <div class="d-flex align-items-center mt-2">
                                        <button @click="reduceItem(product.product_id)" class="btn btn-cart"
                                            style="font-size: 12px; padding: 5px 10px;">-</button>
                                        <span class="mx-2"> &nbsp; {{ product.quantity }} &nbsp;</span>
                                        <button @click="addItem(product.product_id)" class="btn btn-colour"
                                            style="font-size: 12px; padding: 5px 10px;">+</button>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <p class="mb-0">${{ (product.price * product.quantity).toFixed(2) }}</p>
                    
                                <button @click="removeItem(product.product_id)" class="btn btn-color w-50"
                                    style="font-size: 12px; padding: 10px 10px; border-radius: 50px;">
                                    Remove All
                                </button>
                            </div>
                        </div>
                        <div class="mt-5">
                            <a href="checkout.html">
                                <button class="btn btn-check w-50"
                                    style="font-size: 12px; padding: 15px 15px; border-radius: 50px; margin-top: 20px;">
                                    Checkout (${{ getTotalPrice() }})
                                </button>
                            </a>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    searchQuery: '',
                    products: [],
                    cart: [],
                    isCartExpanded: false
                }
            },
            methods: {
                async searchProducts() {
                    const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                    const apiUrl = 'https://serpapi.com/search.json';

                    try {
                        const response = await axios.get(proxyUrl + apiUrl, {
                            params: {
                                engine: 'home_depot',
                                q: this.searchQuery,
                                api_key: 'fe91d8750978cb8b0701954447cf39b63d9ef62ccb58455a9d0f664a3f024797'
                            }
                        });
                        // Ensure each product has a price property
                        console.log(response.data.products)
                        this.products = response.data.products.map(product => ({
                            ...product,
                            price: parseFloat(product.price || 0) // Convert price to number and handle missing prices
                        }));
                    } catch (error) {
                        console.error('Error fetching products:', error);
                    }
                },
                getTotalPrice() {
                    return this.cart.reduce((total, product) => {
                        // Handle potential missing or invalid prices
                        const itemPrice = parseFloat(product.price) || 0;
                        const quantity = parseInt(product.quantity) || 0;
                        const itemTotal = itemPrice * quantity;

                        console.log(`Item: ${product.product_id}, Price: ${itemPrice}, Quantity: ${quantity}, Total: ${itemTotal}`);
                        return total + itemTotal;
                    }, 0).toFixed(2);
                },
                addToCart(id) {
                    let product = this.products.find((product) => product.product_id == id);
                    let index = this.cart.findIndex((product) => product.product_id == id);
                    if (index != -1) {
                        this.cart[index].quantity++;
                    } else {
                        this.cart.push({ ...product, quantity: 1 });
                    }
                },
                reduceItem(id) {
                    const index = this.cart.findIndex(product => product.product_id === id);
                    if (index !== -1) {
                        if (this.cart[index].quantity > 1) {
                            this.cart[index].quantity--;
                        } else {
                            this.removeItem(id);
                        }
                    }
                },
                addItem(id) {
                    const index = this.cart.findIndex(product => product.product_id === id);
                    if (index !== -1) {
                        // Increment the quantity if the item exists
                        this.cart[index].quantity++;
                    }
                    console.log(this.cart);
                },
                removeItem(id) {
                    const index = this.cart.findIndex(product => product.product_id === id);
                    if (index !== -1) {
                        this.cart.splice(index, 1);
                    }
                    console.log(this.cart);
                },
                toggleCart() {
                    this.isCartExpanded = !this.isCartExpanded;
                }
            },
            computed: {
                // Add a computed property for cart total
                cartTotal() {
                    return this.getTotalPrice();
                }
            }
        }).mount('#marketplace');
    </script>
</body>

</html>